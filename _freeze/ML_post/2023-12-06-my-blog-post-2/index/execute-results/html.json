{
  "hash": "b4bc2d9255d31b781229fd20c4594571",
  "result": {
    "markdown": "---\ntitle: \"Clustering\"\ndescription: \"ML assignment blog 2\"\ndate: 2023-12-02\ncategories: [Machine Learning] \ndraft: false\n\n---\n\n\n## 1. Install and call the required libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(c(\"factoextra\", \"FactoMineR\", \"nloptr\", \"lme4\", \"car\", \"rstatix\",\n                  # \"ggpubr\"), dependencies = T)\n\n#install.packages(\"FactoMineR\")\n\n\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n:::\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(knitr)\nlibrary(skimr)\n```\n:::\n\n## Data summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata= penguins_raw %>% clean_names()\n\nskim(penguins_raw)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |             |\n|:------------------------|:------------|\n|Name                     |penguins_raw |\n|Number of rows           |344          |\n|Number of columns        |17           |\n|_______________________  |             |\n|Column type frequency:   |             |\n|character                |9            |\n|Date                     |1            |\n|numeric                  |7            |\n|________________________ |             |\n|Group variables          |None         |\n\n\n**Variable type: character**\n\n|skim_variable     | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-----------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|studyName         |         0|          1.00|   7|   7|     0|        3|          0|\n|Species           |         0|          1.00|  33|  41|     0|        3|          0|\n|Region            |         0|          1.00|   6|   6|     0|        1|          0|\n|Island            |         0|          1.00|   5|   9|     0|        3|          0|\n|Stage             |         0|          1.00|  18|  18|     0|        1|          0|\n|Individual ID     |         0|          1.00|   4|   6|     0|      190|          0|\n|Clutch Completion |         0|          1.00|   2|   3|     0|        2|          0|\n|Sex               |        11|          0.97|   4|   6|     0|        2|          0|\n|Comments          |       290|          0.16|  18|  68|     0|       10|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|Date Egg      |         0|             1|2007-11-09 |2009-12-01 |2008-11-09 |       50|\n\n\n**Variable type: numeric**\n\n|skim_variable       | n_missing| complete_rate|    mean|     sd|      p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------------|---------:|-------------:|-------:|------:|-------:|-------:|-------:|-------:|-------:|:-----|\n|Sample Number       |         0|          1.00|   63.15|  40.43|    1.00|   29.00|   58.00|   95.25|  152.00|▇▇▆▅▃ |\n|Culmen Length (mm)  |         2|          0.99|   43.92|   5.46|   32.10|   39.23|   44.45|   48.50|   59.60|▃▇▇▆▁ |\n|Culmen Depth (mm)   |         2|          0.99|   17.15|   1.97|   13.10|   15.60|   17.30|   18.70|   21.50|▅▅▇▇▂ |\n|Flipper Length (mm) |         2|          0.99|  200.92|  14.06|  172.00|  190.00|  197.00|  213.00|  231.00|▂▇▃▅▂ |\n|Body Mass (g)       |         2|          0.99| 4201.75| 801.95| 2700.00| 3550.00| 4050.00| 4750.00| 6300.00|▃▇▆▃▂ |\n|Delta 15 N (o/oo)   |        14|          0.96|    8.73|   0.55|    7.63|    8.30|    8.65|    9.17|   10.03|▃▇▆▅▂ |\n|Delta 13 C (o/oo)   |        13|          0.96|  -25.69|   0.79|  -27.02|  -26.32|  -25.83|  -25.06|  -23.79|▆▇▅▅▂ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  study_name        sample_number      species             region         \n Length:344         Min.   :  1.00   Length:344         Length:344        \n Class :character   1st Qu.: 29.00   Class :character   Class :character  \n Mode  :character   Median : 58.00   Mode  :character   Mode  :character  \n                    Mean   : 63.15                                        \n                    3rd Qu.: 95.25                                        \n                    Max.   :152.00                                        \n                                                                          \n    island             stage           individual_id      clutch_completion \n Length:344         Length:344         Length:344         Length:344        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    date_egg          culmen_length_mm culmen_depth_mm flipper_length_mm\n Min.   :2007-11-09   Min.   :32.10    Min.   :13.10   Min.   :172.0    \n 1st Qu.:2007-11-28   1st Qu.:39.23    1st Qu.:15.60   1st Qu.:190.0    \n Median :2008-11-09   Median :44.45    Median :17.30   Median :197.0    \n Mean   :2008-11-27   Mean   :43.92    Mean   :17.15   Mean   :200.9    \n 3rd Qu.:2009-11-16   3rd Qu.:48.50    3rd Qu.:18.70   3rd Qu.:213.0    \n Max.   :2009-12-01   Max.   :59.60    Max.   :21.50   Max.   :231.0    \n                      NA's   :2        NA's   :2       NA's   :2        \n  body_mass_g       sex            delta_15_n_o_oo  delta_13_c_o_oo \n Min.   :2700   Length:344         Min.   : 7.632   Min.   :-27.02  \n 1st Qu.:3550   Class :character   1st Qu.: 8.300   1st Qu.:-26.32  \n Median :4050   Mode  :character   Median : 8.652   Median :-25.83  \n Mean   :4202                      Mean   : 8.733   Mean   :-25.69  \n 3rd Qu.:4750                      3rd Qu.: 9.172   3rd Qu.:-25.06  \n Max.   :6300                      Max.   :10.025   Max.   :-23.79  \n NA's   :2                         NA's   :14       NA's   :13      \n   comments        \n Length:344        \n Class :character  \n Mode  :character  \n                   \n                   \n                   \n                   \n```\n:::\n:::\n\n## Visualisation and correlation check\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n\n```{.r .cell-code}\nggpairs(\n  data = data,\n  columns = c(9:14),\n  diag = list(continuous = wrap(\"barDiag\", color = \"red\")),\n  upper = list(continuous = wrap(\"cor\", bins = 40))\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\nThere is a high correlation observed between body_mass_g and flipper_length. So, I opt to remove the one of the two variables. I am removing the body_mass_g variable from the dataset.\n\n## Data wrangling\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   penguins = data %>%\n      mutate (\n         id = row_number(),\n         species = word (species, 1),\n         culmen_length_mm = scale(culmen_length_mm),\n         culmen_depth_mm = scale(culmen_depth_mm),\n         flipper_length_mm = scale(flipper_length_mm)\n         ) %>%\n      select (id, species, island, sex, culmen_length_mm, culmen_depth_mm, flipper_length_mm) %>%\n      drop_na (sex)\n\nsummary(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       id          species             island              sex           \n Min.   :  1.0   Length:333         Length:333         Length:333        \n 1st Qu.: 90.0   Class :character   Class :character   Class :character  \n Median :173.0   Mode  :character   Mode  :character   Mode  :character  \n Mean   :174.3                                                           \n 3rd Qu.:259.0                                                           \n Max.   :344.0                                                           \n culmen_length_mm.V1   culmen_depth_mm.V1  flipper_length_mm.V1\n Min.   :-2.1653537   Min.   :-2.0514400   Min.   :-2.0563073  \n 1st Qu.:-0.8099390   1st Qu.:-0.7854846   1st Qu.:-0.7762357  \n Median : 0.1058817   Median : 0.0753651   Median :-0.2784301  \n Mean   : 0.0129796   Mean   : 0.0069350   Mean   : 0.0036811  \n 3rd Qu.: 0.8568547   3rd Qu.: 0.7843001   3rd Qu.: 0.8594113  \n Max.   : 2.8716604   Max.   : 2.2021701   Max.   : 2.1394829  \n```\n:::\n:::\n\nThe NA's are dropped. ID is added to each row. The variables culmen_length_mm, culmen_depth_mm and flipper_length_mm are scaled. We will use PCA analysis to reduce the dimensionality of the dataset. We will only use culmen_length_mm, culmen_depth_mm and flipper_length_mm for the K-means clustering and PCA.\n\n## PCA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#library(factoextra)\n#library(FactoMineR)\n\n#PCA = PCA(penguins[5:7], graph = F)\n#fviz_screeplot(penguins_PCA)\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}